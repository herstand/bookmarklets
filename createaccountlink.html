<html>

<head>
    <script>
        const GetUserAccountLink = async () => {
            const userData = (await (await fetch(`https://api.v2.limberhealth.com/user/${atob(window.location.pathname.substring(window.location.pathname.lastIndexOf("/") + 1))}`)).json())[0];
            alert(`The Create Account Link for ${userData.first_name} ${userData.last_name} is: https://limberv2.app.link/create-account-limber?uid=${userData.id}&uuid=${userData.uuid}`);
        }

        const code = GetUserAccountLink.toString();
        const GetUserAccountLinkdURI = encodeURI(`javascript:(${code})()`);
        console.log(GetUserAccountLinkdURI);
        
        const GetUserAccountLink_v3 = async () => {
            const userData = (await (await fetch(`https://main-api.v3.limberhealth.com/user/${atob(window.location.pathname.substring(window.location.pathname.lastIndexOf("/") + 1))}`)).json())[0];
            alert(`The Create Account Link for ${userData.first_name} ${userData.last_name} is: https://limberv2.app.link/create-account-limber?uid=${userData.id}&uuid=${userData.uuid}`);
        }

        const code_v3 = GetUserAccountLink_v3.toString();
        const GetUserAccountLinkdURI_v3 = encodeURI(`javascript:(${code_v3})()`);
        console.log(GetUserAccountLinkdURI);
        
    </script>
</head>

<body>
    <h1>Drag a button to your bookmarks bar and click it when on a user's profile.</h1>
    <p>
        <a style="background:purple;color:white;border-radius:5px;padding:5px;text-decoration:none" id="createAccountLinkv3"
        href="">Get App Deeplink V3</a>
    </p>
    <p>
        <a style="background:purple;color:white;border-radius:5px;padding:5px;text-decoration:none" id="createAccountLink"
        href="">Get App Deeplink v2</a>
    </p>
    
    <script>
        document.getElementById("createAccountLink").href = GetUserAccountLinkdURI;
        document.getElementById("createAccountLinkv3").href = GetUserAccountLinkdURI_v3;
    </script>
</body>

</html>
